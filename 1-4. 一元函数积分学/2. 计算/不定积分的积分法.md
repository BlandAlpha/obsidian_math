---
属性: 正文
上一层级: "[[4-2. 计算]]"
tags:
- 重要
---

> [!warning] 
> 本篇笔记含有 *滥用 Callout* 的情况。请将多个同时出现的 Callout 当作不同的分段。

## 凑微分法

$$\int f[g(x)] g'(x) \mathrm{d}x = \int f[g(x)] \mathrm{d}[g(x)] = \int f(u) \mathrm{d}u$$

> [!tldr]
>  
> 若被积函数比较复杂，则拿出一部分放到 $\mathrm{d}$ 后面去（换元）。若能凑成基本函数形式，则成功。
> 
> > [!example] 
> > $$\int \frac{\ln^{5}x}{x} \mathrm{d}x = \int \ln^{5}x \cdot \frac{1}{x} \mathrm{d}x = \int \ln^{5}x \mathrm{d}(\ln x) = \frac{\ln^{6}x}{6}+C$$

---

## 换元法

令 $x=g(u)$：

$$\int f(x) \mathrm{d}x \Longrightarrow \int f[g(x)] \mathrm{d}[g(u)] = \int f[g(u)]g'(u) \mathrm{d}u$$

>[!tip] 
>
> - 当被积函数不容易积分时 *(根号、复杂分母、反三角函数)* ，可以考虑使用换元。
> - 计算结束别忘了回代。
> - 核心思想：**令复杂部分等于 $t$**。

### 1. 三角代换

当被积函数包含如下根式，可用三角代换（这里 $a>0$）：

$$\sqrt{a^{2} - x^{2}} \to 令~ x = a \sin t, |t| < \frac{\pi}{2}$$

$$\sqrt{a^{2} + x^{2}} \to 令~ x = a \tan t, |t| < \frac{\pi}{2}$$

$$\sqrt{x^{2} - a^{2}} \to 令~ x = a \sec t, \begin{cases} 若~x>0,~ 0 < t < \frac{\pi}{2}  \\ 若~x<0,~ \frac{\pi}{2} < t < \pi \end{cases}$$

### 2. 恒等变形后三角代换

当被积函数包含根式 $\sqrt{ax^{2} + bx + c}$ 时，可先化为以下三种形式：

- $\sqrt{\varphi^{2}(x) + k^2}$
- $\sqrt{\varphi^{2}(x) - k^2}$
- $\sqrt{k^{2}- \varphi^{2}(x)}$

再作代换。

### 3. 根式代换

> [!quote] 
> 
> ***“举重若轻”***

当被积函数包含根式如：

- $\sqrt[n]{ax+b}$
- $\sqrt{\frac{ax+b}{cx+d}}$
- $\sqrt{ae^{bx}+c}$
- $\cdots$

时，直接令根式 $\sqrt{*} = t$。

> [!tip] 
>
> 对于同时含有 $\sqrt[m]{ax+b}$ 和 $\sqrt[n]{ax+b}$ 的函数，取其最小公倍数。

> [!info]
>  
> 事实上，很难通过根号内换元的方法凑成平方，所以根号无法去掉。

### 4. 倒代换

当被积函数分母的幂次比分子**高2次及以上**时，令 $x=\frac{1}{t}$。

> [!example] 
> 
> $$\int \frac{1}{x(x^{3}+1)} \mathrm{d}x$$
> $$=\int \frac{x^2}{x^3(x^{3}+1)} \mathrm{d}x$$
> $$=\frac{1}{3}\int \frac{1}{x^3(x^{3}+1)} \mathrm{d}x^3$$
> 令 $x^{3} = t$
> $$=\frac{1}{3} \int \frac{1}{t(t+1)} \mathrm{d}t$$
> $$=\frac{1}{3} ( \ln |t| - \ln |t+1|)+C$$
> $$=\frac{1}{3} \ln \left| \frac{x^{3}}{x^{3}+1} \right| + C$$

### 5. 复杂函数直接代换

当被积函数中含有 $a^{x},~e^{x},~\ln x,~ \arcsin x,~ \arctan x$ 等时，考虑将其直接等于 $t$。

> [!tip]
>  
> 当 $\ln x,~ \arcsin x,~ \arctan x$ 与多项式或 $e^{ax}$ 作乘法时，优先考虑**分部积分法**。

---

## 分部积分法

$$\int u \mathrm{d}v = uv - \int v \mathrm{d}u$$

> [!tip] 
> - 适用于 $\int u \mathrm{d}v$ 求解困难，而 $\int v \mathrm{d}u$ 求解容易的情况；
> - 可能需要多次使用分部积分。如果发现需要迭代的次数过多，请使用 [[#分部积分法推广公式]]。

> [!info] 
> 
> 分部积分法推导：
> 
> $$(uv)' = u'v + uv'$$
> 移项得：
> $$u'v = (uv)' - uv'$$
> 同时对两边进行不定积分：
> $$\int u'v \mathrm{d}x = uv - \int uv' \mathrm{d}x$$
> 也可以写成：
> $$\int u \mathrm{d}v = uv - \int v \mathrm{d}u$$

> [!tip] 如何选取 $u,v$ ？
> 
> > [!quote] 
> > $$反 \qquad 对 \qquad 幂 \qquad 指 \qquad 三$$
> > $$u \longleftarrow   \qquad \qquad \longrightarrow v$$
> > $$\arcsin x \qquad \ln x \qquad x^{2} \qquad e^{x} \qquad \sin x$$
> 
> 越靠左越不好积分，更易取 $u$ 用于求导，靠右好积分，则取 $v$ 用于积分。

> [!example] 
> $$\int \ln (1+x^{2}) \mathrm{d}x$$
> $$=\int \ln (1+x^{2}) \cdot (x)' \mathrm{d}x$$
> 换元，代分部积分公式：
> $$=\int u \cdot v' \mathrm{d}x$$
> $$= uv - \int v \cdot u' \mathrm{d}x$$
> 回代：
> $$= x \ln (1+x^{2}) - \int x \cdot \frac{2x}{1+x^{2}} \mathrm{d}x$$
> 凑积分，拆分成为 [[基本积分公式]]：
> $$= x \ln (1+x^{2}) - 2 \int \frac{x^{2}+1-1}{1+x^{2}} \mathrm{d}x$$
> $$= x \ln (1+x^{2}) - 2 \left( \int 1 \mathrm{d}x - \int \frac{1}{1+x^{2}} \mathrm{d}x \right )$$
> 应用基本积分公式：
> $$= x \ln (1+x^{2}) - 2x + 2 \arctan x + C$$

### 分部积分法推广公式

设 $u, v$ 均有 $n+1$ 阶连续导数，则：

$$\int uv^{(n+1)} \mathrm{d}x = u'v^{(n-1)} - u^{''}v^{(n-1)} + \cdots + (-1)^{n} u^{(n)} $$